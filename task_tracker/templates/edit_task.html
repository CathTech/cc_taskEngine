<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Редактировать задачу - Task Tracker</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            padding-top: 20px;
            padding-bottom: 40px;
            background-color: #f5f5f5;
        }
        .header {
            margin-bottom: 30px;
        }
        .card {
            margin-bottom: 20px;
            box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
            border: 1px solid rgba(0, 0, 0, 0.125);
        }
        .form-container {
            max-width: 800px;
            margin: 0 auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Редактировать задачу</h1>
            <p class="lead">ID задачи: {{ task_id_display }}</p>
        </div>
        
        <div class="form-container">
            <div class="card">
                <div class="card-body">
                    <form method="POST">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="title" class="form-label">Задача</label>
                                    <input type="text" class="form-control" id="title" name="title" value="{{ task.title }}" required>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="planned_date" class="form-label">Запланировано на</label>
                                    <input type="date" class="form-control" id="planned_date" name="planned_date" 
                                           value="{{ task.planned_date or '' }}">
                                </div>
                                
                                <div class="mb-3">
                                    <label for="planned_start_time" class="form-label">Время начала</label>
                                    <input type="time" class="form-control" id="planned_start_time" name="planned_start_time"
                                           value="{{ task.planned_start_time or '' }}">
                                </div>
                                
                                <div class="mb-3">
                                    <label for="deadline" class="form-label">Дедлайн</label>
                                    <input type="date" class="form-control" id="deadline" name="deadline" 
                                           value="{{ task.deadline or '' }}">
                                </div>
                                
                                <div class="mb-3">
                                    <label for="priority" class="form-label">Приоритет</label>
                                    <select class="form-select" id="priority" name="priority">
                                        <option value="Прочее" {% if task.priority == 'Прочее' %}selected{% endif %}>Прочее</option>
                                        <option value="Низкий" {% if task.priority == 'Низкий' %}selected{% endif %}>Низкий</option>
                                        <option value="Базовый" {% if task.priority == 'Базовый' %}selected{% endif %}>Базовый</option>
                                        <option value="Важный" {% if task.priority == 'Важный' %}selected{% endif %}>Важный</option>
                                        <option value="Срочный" {% if task.priority == 'Срочный' %}selected{% endif %}>Срочный</option>
                                    </select>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="color" class="form-label">Цвет задачи</label>
                                    <input type="color" class="form-control form-control-color" id="color" name="color" 
                                           value="{{ task.color or '#1098ad' }}">
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="description" class="form-label">Описание</label>
                                    <textarea class="form-control" id="description" name="description" rows="5">{{ task.description or '' }}</textarea>
                                </div>
                                
                                <div class="mb-3 form-check">
                                    <input type="checkbox" class="form-check-input" id="show_in_calendar" name="show_in_calendar" 
                                           {% if task.show_in_calendar %}checked{% endif %}>
                                    <label class="form-check-label" for="show_in_calendar">Отображать в календаре</label>
                                </div>
                                
                                <div class="mb-3 form-check">
                                    <input type="checkbox" class="form-check-input" id="completed" name="completed" 
                                           {% if task.completed %}checked{% endif %}>
                                    <label class="form-check-label" for="completed">Выполнено</label>
                                </div>
                                
                                <div class="mb-3 form-check">
                                    <input type="checkbox" class="form-check-input" id="kanban_enabled" name="kanban_enabled"
                                           {% if task.kanban_enabled %}checked{% endif %}>
                                    <label class="form-check-label" for="kanban_enabled">Показывать в Kanban</label>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="kanban_status" class="form-label">Статус Kanban</label>
                                    <select class="form-select" id="kanban_status" name="kanban_status">
                                        <option value="Новая" {% if task.kanban_status == 'Новая' %}selected{% endif %}>Новая</option>
                                        <option value="В работе" {% if task.kanban_status == 'В работе' %}selected{% endif %}>В работе</option>
                                        <option value="Горит" {% if task.kanban_status == 'Горит' %}selected{% endif %}>Горит</option>
                                        <option value="Важно" {% if task.kanban_status == 'Важно' %}selected{% endif %}>Важно</option>
                                        <option value="Буфер" {% if task.kanban_status == 'Буфер' %}selected{% endif %}>Буфер</option>
                                        <option value="Базовая" {% if task.kanban_status == 'Базовая' %}selected{% endif %}>Базовая</option>
                                        <option value="Закрытые" {% if task.kanban_status == 'Закрытые' %}selected{% endif %}>Закрытые</option>
                                        <option value="Все задачи" {% if task.kanban_status == 'Все задачи' %}selected{% endif %}>Все задачи</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                            <a href="{{ url_for('task_detail', task_id=task.id) }}" class="btn btn-secondary me-md-2">Отменить</a>
                            <button type="submit" class="btn btn-primary">Сохранить изменения</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>